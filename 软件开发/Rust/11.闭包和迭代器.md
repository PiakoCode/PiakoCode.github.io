# 闭包和迭代器


## 迭代器

iterators5.rs

Rust提供了迭代器（Iterator）类型，它是一种用于遍历集合（如数组、向量、哈希表等）元素的机制。迭代器提供了一系列方法，可以对集合进行各种操作，如过滤、映射、搜索等。

要使用迭代器，首先需要通过调用集合对象的`iter`方法来创建一个迭代器对象。然后，可以使用迭代器对象上的各种方法进行遍历和操作。

下面是一些常用的迭代器方法：

1. `iter()`：创建一个不可变迭代器，用于遍历集合中的每个元素。
2. `iter_mut()`：创建一个可变迭代器，用于遍历集合中的每个元素并进行修改。
3. `enumerate()`：返回一个元素和其索引的元组的迭代器，可以用于同时遍历集合中的元素和它们的索引。
4. `filter()`：根据指定的条件过滤集合中的元素，返回满足条件的元素的迭代器。
5. `map()`：对集合中的每个元素应用一个函数并返回结果的迭代器。
6. `collect()`：将迭代器中的元素收集到一个集合中，并返回该集合。
7. `take()`：只获取迭代器中的前几个元素。
8. `skip()`：跳过迭代器中的前几个元素。

除了上述方法，还有很多其他的迭代器方法可以在Rust的标准库文档中找到。

下面是一个简单的例子，展示了如何使用迭代器对一个数组进行遍历和操作：

```rust
fn main() {
    let numbers = [1, 2, 3, 4, 5];

    // 遍历并打印数组中的每个元素
    for num in numbers.iter() {
        println!("{}", num);
    }

    // 对数组中的每个元素进行平方操作，并收集到一个向量中
    let squares: Vec<i32> = numbers.iter().map(|&num| num * num).collect();

    // 打印新生成的向量
    println!("{:?}", squares);
}
```

在上面的例子中，我们首先使用`iter`方法创建了一个数组的不可变迭代器，然后使用`for`循环遍历了数组中的每个元素并打印出来。接下来，我们使用`map`方法对数组中的每个元素进行平方操作，然后使用`collect`方法将结果收集到一个向量中，并最后打印出新生成的向量。


要使用HashMap的迭代器，首先需要导入HashMap的模块：

```rust
use std::collections::HashMap;
```

然后，你可以创建一个HashMap，并使用`iter`方法获取它的迭代器：

```rust
let mut map = HashMap::new();
map.insert("key1", "value1");
map.insert("key2", "value2");
map.insert("key3", "value3");

for (key, value) in map.iter() {
    println!("Key: {}, Value: {}", key, value);
}
```

在这个例子中，我们使用`iter`方法获取HashMap的不可变引用，然后使用一个`for`循环来遍历迭代器中的键值对。每个键值对都被解构为一个`key`和一个`value`变量，你可以根据需要对它们进行操作。

### HashMap的迭代器

如果你需要对HashMap的可变引用进行迭代，可以使用`iter_mut`方法：

```rust
for (key, value) in map.iter_mut() {
    *value = "new value";
}
```

在这个例子中，我们使用`iter_mut`方法获取HashMap的可变引用，并使用`*`操作符来修改迭代器中的值。

除了`iter`和`iter_mut`方法外，HashMap还提供了其他一些有用的方法来处理键值对，包括`into_iter`、`keys`和`values`。你可以根据自己的需求选择合适的方法来迭代HashMap的内容。